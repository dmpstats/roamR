<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case Study: guillemot Isle of May • roamR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Study: guillemot Isle of May">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">roamR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Case Study: guillemot Isle of May</h1>
            
      

      <div class="d-none name"><code>case-study-guillemot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Here we use <a href="https://dmpstats.github.io/roamR/">roamR</a> to simulate the movement and
energetics for a population of common guillemot (<em>Uria aalge</em>) on
the Isle of May. For broad-scale details on the <a href="https://dmpstats.github.io/roamR/">roamR</a>
package, refer to the general guide, with the general architecture
repeated here:</p>
<p><img src="images%2FroamR_schema.png" class="zoomable" alt="general class structure and hierarchy for the `roamR` package"></p>
<p>The simulations here cover the non-breeding season (some 9 months,
from July to March) under two broad scenarios:</p>
<ul>
<li>An environment free of Offshore Windfarms (OWFs) - nominally the
status quo</li>
<li>An environment with many synthetic OWF developments</li>
</ul>
<div class="float">
<img src="images%2Fguill_OWF_scenario.png" alt="Figure 2: Synthetic windfarms within North Sea, against a predicted guillemot density surface. Density is clipped to the AoC, windfarms are the light blue boxes. Anything beyond the AoC boundaries are excluded from calculations"><div class="figcaption"><strong>Figure 2: Synthetic windfarms within
North Sea, against a predicted guillemot density surface. Density is
clipped to the AoC, windfarms are the light blue boxes. Anything beyond
the AoC boundaries are excluded from calculations</strong></div>
</div>
<p>The overall intention is to quantify the effects of potential
displacement from these developments, based on counterfactual
comparisons of animal’s condition under these scenarios. In keeping with
the architecture of the <a href="https://dmpstats.github.io/roamR/">roamR</a> package, the following main
components will be populated:</p>
<ul>
<li>
<strong>IBM general settings</strong>
(<code>&lt;ModelConfig&gt;</code>) sundry high-level controls for the
simulation, such as the number of agents, broad spatial boundaries,
spatial projections, time-steps, start &amp; finish dates.</li>
<li>
<strong>Species-level information</strong>
(<code>&lt;Species&gt;</code>) such as distributions governing initial
body mass, what behavioural states are possible, movement parameters,
and how agents respond to their environment e.g. avoidance of windfarms
or landmass, costs associated with activity.</li>
<li>
<strong>Drivers</strong> (<code>&lt;Driver&gt;</code>)
descriptions/data that define the environment that agents may interact
with or respond to e.g. sea surface temperatures, locations of
windfarms, coastlines, prey fields etc.</li>
</ul>
<p>The extent to which these can be reliably populated will obviously
vary, with the guillemot chosen here as a population that is relatively
well studied. <a href="https://dmpstats.github.io/roamR/">roamR</a> is intentionally general and has
substantial functionality that will not be used in a simulation. We will
populate various elements of the simulation in turn, before turning to
running the simulation and post-processing the results.</p>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>As a relatively well-studied species/population, there are many
<a href="https://dmpstats.github.io/roamR/">roamR</a> elements to populate. Mainly these are:</p>
<ul>
<li>Density maps</li>
<li>SST</li>
<li>Activity data</li>
<li>Energetics</li>
<li>Bodyweight</li>
<li>body mass conversion</li>
</ul>
<p>which will be a) described in detail and b) specified in
<a href="https://dmpstats.github.io/roamR/">roamR</a> forms in the following sections.
<a href="https://dmpstats.github.io/roamR/">roamR</a> can be run with very little data (an example of a
more data sparse species is given in the alternative test case of
red-throated divers), with the results being correspondingly less
informative and more stochastic.</p>
<div class="section level3">
<h3 id="ibm-configuration">IBM configuration<a class="anchor" aria-label="anchor" href="#ibm-configuration"></a>
</h3>
<p>The broad configuration of the IBM is specified via the function
<code><a href="../reference/ModelConfig.html">ModelConfig()</a></code>.In the interest of speed, the example
simulation here will not be large in terms of the number of agents to
run - we’ll opt for few agents (<code>n_agents</code>), whereas a
typical run would be 1000s. The non-breeding season for these animals
runs from approximately start of July for 9 months
(<code>start_date</code>, <code>end_date</code>). We’ll opt for a
uniform 1km^2 spatial resolution (<code>x_delta</code>,
<code>y_delta</code>) and have everything operate on the UTM 30N
coordinate system (<code>ref_sys</code>). This will be the basis of
ingesting and aligning the general spatial inputs. Note: the package
currently requires all spatial inputs (e.g. density maps) to be provided
in a common Coordinate Reference System (CRS) <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;functionality to homogenise CRSs across spatial inputs
during model initialization is expected to be implemented in
&lt;a href="https://dmpstats.github.io/roamR/"&gt;roamR&lt;/a&gt; in the near future&lt;/p&gt;'><sup>1</sup></a>. The <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a>
package is generally used for dealing with spatial data (and the
interlinked <a href="https://r-spatial.github.io/stars/" class="external-link">stars</a> package for spatiotemporal).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set UTM zone 30N</span></span>
<span><span class="va">utm30</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">32630</span><span class="op">)</span></span></code></pre></div>
<p>Agent start and end locations (<code>start_sites</code>,
<code>end_sites</code>) must be supplied as<code>sf</code> objects
containing two required columns: <code>id</code> (a unique site
identifier) and <code>prop</code> (the proportion of agents assigned to
each site).</p>
<p>In this example, we use the Isle of May as the sole starting
location, specified by its geographic coordinates (longitude/latitude).
Note that <code>end_sites</code> is not utilised in this the simulation,
meaning the movement model assumes agents remain at their final
locations once the simulation ends. As noted earlier, the site must be
re-projected to the common UTM Zone 30N coordinate reference system.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># location of colony in long/lat degrees - start/finish locations</span></span>
<span><span class="va">isle_may</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"Isle of May"</span>,</span>
<span>  prop <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  geom <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5667</span>, <span class="fl">56.1833</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># re-project to UTM 30N</span></span>
<span><span class="va">isle_may</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">isle_may</span>, crs <span class="op">=</span> <span class="va">utm30</span><span class="op">)</span></span></code></pre></div>
<p>In terms of bounding the entire simulation spatially, we’ve opted for
a semi-arbitrary bounding box around the Isle of May that encompasses a
large swathe of the North Sea and far to the west of the UK, which
covers the bulk of the guillemot density maps. Note this a hard boundary
in terms of simulations - data outside this will have no influence.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">AoC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">178831</span>, ymin <span class="op">=</span> <span class="fl">5906535</span>,  xmax <span class="op">=</span> <span class="fl">1174762</span>, ymax <span class="op">=</span> <span class="fl">6783609</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">utm30</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Passing the above configuration inputs to <code><a href="../reference/ModelConfig.html">ModelConfig()</a></code>
creates a <code>&lt;ModelConfig&gt;</code> object, which we assigned to
<code>guill_ibm_config</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># IBM Settings - assume fixed for these simulations</span></span>
<span></span>
<span><span class="va">guill_ibm_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelConfig.html">ModelConfig</a></span><span class="op">(</span></span>
<span>  n_agents <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  ref_sys <span class="op">=</span> <span class="va">utm30</span>,</span>
<span>  aoc_bbx <span class="op">=</span> <span class="va">AoC</span>, </span>
<span>  delta_x <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  delta_y <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  delta_time <span class="op">=</span> <span class="st">"1 day"</span>,</span>
<span>  start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/date.html" class="external-link">date</a></span><span class="op">(</span><span class="st">"2025-07-01"</span><span class="op">)</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/date.html" class="external-link">date</a></span><span class="op">(</span><span class="st">"2025-07-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">270</span>, </span>
<span>  start_sites <span class="op">=</span> <span class="va">isle_may</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">guill_ibm_config</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ModelConfig"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "roamR"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="driver-information---specifying-the-environment">Driver information - specifying the environment<a class="anchor" aria-label="anchor" href="#driver-information---specifying-the-environment"></a>
</h3>
<p>Drivers define the environment that agents may interact with or
respond, with each driver being specified via the <code><a href="../reference/Driver.html">Driver()</a></code>
function. The scope of these will be defined by the level of knowledge
for the species in hand - at the minimum the agents would not be
responsive to the environment. Any environmental component that can/will
be functionally linked to the animal’s behaviour (activity states or
movement) or their energetics, must be included in the definition of the
environment via the drivers.</p>
<p>In this application to the common guillemot, the following drivers
are required - all provided as spatio-temporal datacubes (2D rasters
giving values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math>
locations over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
times) so the agents can query their environment at any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">x, y, t</annotation></semantics></math>:</p>
<ul>
<li>Monthly species density surfaces, for both baseline and impacted
scenarios (<span class="citation">Buckingham et al. (2023)</span>).
These give monthly density predictions around the UK at a 10 sq-km
resolution (with bootstrap uncertainties).</li>
<li>Monthly energy intake maps (kJ/h), for both baseline and impacted
scenarios based on density maps above, and conspecifics (other
Guillemots, refer below).</li>
<li>Monthly average Sea Surface Temperature (SST) maps (National Oceanic
and Atmospheric Administration/NOAA <a href="https://downloads.psl.noaa.gov/Datasets/noaa.oisst.v2.highres/" class="external-link">here</a>).</li>
</ul>
<p><a href="https://dmpstats.github.io/roamR/">roamR</a> enforces a strict requirement that all input
variables be accompanied by appropriate measurement units. This ensures
that all computations performed during simulation are unit-aware,
allowing for accurate operations and conversions.</p>
<p>We begin by uploading these datacubes, assigning measurement units
where they are missing.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># driver spatial surfaces</span></span>
<span></span>
<span><span class="va">spec_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"data/bioss_spec_map.rds"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span>density <span class="op">=</span>  <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">density</span>, <span class="st">"counts"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spec_imp_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"data/bioss_spec_imp_map.rds"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span>density <span class="op">=</span>  <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">density</span>, <span class="st">"counts"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">intake_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"data/guill_energy_intake_map.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">imp_intake_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"data/guill_impacted_energy_intake_map.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sst_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"data/bioss_sst_stars.rds"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>sst <span class="op">=</span>  <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">sst</span>, <span class="st">"degree_Celsius"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_warp.html" class="external-link">st_warp</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">spec_map</span><span class="op">)</span>, threshold  <span class="op">=</span> <span class="fl">20028</span><span class="op">)</span></span></code></pre></div>
<p>Next we specify the corresponding drivers, and stored the as a list
of <code>&lt;Driver&gt;</code> objects. Collectively these define the
environment the agents will move through. This is very flexible, and can
comprise of coastal polygons, OWF footprints, prey-fields etc. Here
we’re providing sea surface temperature animal density surfaces, and
maps that reflect the energy Note here we’re adopting the
<em>density-informed</em> movement model (refer guidance document) which
uses density maps for location preference. The feasible locations are
defined by the density surfaces (so coast is implicit), and OWF are
similarly implicit in the “impact” density surfaces, where OWF-sensitive
agents avoid developments.</p>
<p>Here the energetics maps reflect an Ideal Free Distribution (IFD) in
the unimpacted case i.e. the agent’s energy requirements are met on
average - their distribution reflects the underlying resource. The
impacted energy maps reflect displacement from the OWF footprints,
including the conspecifics, meaning a proportional reduction in the IFD
due to competition from other guillemot e.g. twice as many individuals
means 1/2 the resource.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up IBM drivers </span></span>
<span></span>
<span><span class="va">dens_drv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Driver.html">Driver</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"dens"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"resource"</span>,</span>
<span>  descr <span class="op">=</span> <span class="st">"species dens map"</span>,</span>
<span>  stars_obj <span class="op">=</span> <span class="va">spec_map</span>,</span>
<span>  obj_active <span class="op">=</span> <span class="st">"stars"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dens_imp_drv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Driver.html">Driver</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"dens_imp"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"resource"</span>,</span>
<span>  descr <span class="op">=</span> <span class="st">"species redist map"</span>,</span>
<span>  stars_obj <span class="op">=</span> <span class="va">spec_imp_map</span>,</span>
<span>  obj_active <span class="op">=</span> <span class="st">"stars"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">energy_drv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Driver.html">Driver</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"energy"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"resource"</span>,</span>
<span>  descr <span class="op">=</span> <span class="st">"energy map"</span>,</span>
<span>  stars_obj <span class="op">=</span> <span class="va">intake_map</span>,</span>
<span>  obj_active <span class="op">=</span> <span class="st">"stars"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">imp_energy_drv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Driver.html">Driver</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"imp_energy"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"resource"</span>,</span>
<span>  descr <span class="op">=</span> <span class="st">"energy impact map"</span>,</span>
<span>  stars_obj <span class="op">=</span> <span class="va">imp_intake_map</span>,</span>
<span>  obj_active <span class="op">=</span> <span class="st">"stars"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">sst_drv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Driver.html">Driver</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"sst"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"habitat"</span>,</span>
<span>  descr <span class="op">=</span> <span class="st">"Sea Surface Temperature"</span>,</span>
<span>  stars_obj <span class="op">=</span> <span class="va">sst_map</span>,</span>
<span>  obj_active <span class="op">=</span> <span class="st">"stars"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># store as list for initialisation</span></span>
<span><span class="va">guill_drivers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dens <span class="op">=</span> <span class="va">dens_drv</span>,</span>
<span>  imp_dens <span class="op">=</span> <span class="va">dens_imp_drv</span>,</span>
<span>  energy <span class="op">=</span> <span class="va">energy_drv</span>,</span>
<span>  imp_energy <span class="op">=</span> <span class="va">imp_energy_drv</span>,</span>
<span>  sst <span class="op">=</span> <span class="va">sst_drv</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="species-information---properties-that-inform-individual-agents">Species information - properties that inform individual agents<a class="anchor" aria-label="anchor" href="#species-information---properties-that-inform-individual-agents"></a>
</h3>
<p>Species-level information is defined using the <code><a href="../reference/Species.html">Species()</a></code>
function, which depends on a set of input objects. For clarity and
modularity, these inputs should be prepared and specified
beforehand.</p>
<div class="section level4">
<h4 id="states-profile">States Profile<a class="anchor" aria-label="anchor" href="#states-profile"></a>
</h4>
<p>We begin by defining the behavioural states to include in the model.
Each state represents a specific activity, characterized by parameters
such as energy expenditure, time allocation, and movement speed.</p>
<p>States are created using the <code><a href="../reference/State.html">State()</a></code> function.
<a href="https://dmpstats.github.io/roamR/">roamR</a> supports flexible specification of state
properties, allowing the incorporation of stochastic variation at both
the population and individual (agent) level.</p>
<p>Here we include 4 states:</p>
<ul>
<li>flying</li>
<li>diving</li>
<li>active on water (i.e. swimming)</li>
<li>inactive on water (i.e. resting)</li>
</ul>
<p>We start with the ‘flight’ state. For the current simulation, we
assume the energetic cost of flying for each agent varies throughout the
simulation, following a Normal distribution with mean
<code>507.6 kJ/h</code> and standard deviation
of<code>237.6 kJ/h</code>. The source for these figures are <span class="citation">Elliott et al. (2013)</span>.</p>
<p>Stochasticity can enter in various ways, here we specify the average
speed of each agent to be fixed over the simulation (e.g. we’re implying
relatively fast/slow animals), with agents speeds drawn from a uniform
distribution, as specified below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># user-defined function returning the energy cost of flying</span></span>
<span><span class="va">flight_cost_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">e</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="st">"kJ/h"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">flight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/State.html">State</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"flight"</span>, </span>
<span>  energy_cost <span class="op">=</span> <span class="fu"><a href="../reference/VarFn.html">VarFn</a></span><span class="op">(</span></span>
<span>    <span class="va">flight_cost_fn</span>, </span>
<span>    args_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">507.6</span>, sd <span class="op">=</span> <span class="fl">237.6</span><span class="op">)</span>, </span>
<span>    units <span class="op">=</span> <span class="st">"kJ/hour"</span></span>
<span>    <span class="op">)</span>, </span>
<span>  time_budget <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fl">0.056</span>, <span class="st">"hours/day"</span><span class="op">)</span>, </span>
<span>  speed <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">"m/s"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The state representing the ‘diving’ activity <span class="citation">(Elliott et al. 2013)</span> as energy output
contingent on the amount of diving. Here we are performing day-level
calculations, meaning we are far from simulating at the dive level, and
can use a mean dive-length without loss of generality. This is
<code>t_dive</code> and populated later from tag information.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>3.71</mn><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><msub><mi>T</mi><mi>i</mi></msub><mi>/</mi><mn>1.23</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>T</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
e = 3.71\frac{\sum_i(1-e^{-T_i/1.23})}{\sum_iT_i}
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
is the dive length of dive
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in minutes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define costing function</span></span>
<span><span class="va">dive_cost_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t_dive</span>, <span class="va">alpha_mean</span>, <span class="va">alpha_sd</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">alpha_mean</span>, <span class="va">alpha_sd</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">t_dive</span><span class="op">/</span><span class="fl">1.23</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">t_dive</span><span class="op">)</span><span class="op">*</span><span class="fl">60</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="st">"kJ/h"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># Construct &lt;State&gt; object</span></span>
<span><span class="va">dive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/State.html">State</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"diving"</span>, </span>
<span>  energy_cost <span class="op">=</span> <span class="fu"><a href="../reference/VarFn.html">VarFn</a></span><span class="op">(</span></span>
<span>    <span class="va">dive_cost_fn</span>, </span>
<span>    args_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>t_dive <span class="op">=</span> <span class="fl">1.05</span>, alpha_mean <span class="op">=</span> <span class="fl">3.71</span>, alpha_sd <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span>, </span>
<span>    units <span class="op">=</span> <span class="st">"kJ/hour"</span></span>
<span>    <span class="op">)</span>, </span>
<span>  time_budget <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fl">3.11</span>, <span class="st">"hours/day"</span><span class="op">)</span>, </span>
<span>  speed <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"m/s"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>State representing ‘active on water’ <span class="citation">(Buckingham et al. 2023)</span> is a linear function in
SST:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>a</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>*</mo><mi>S</mi><mi>S</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
e = a-(b*SST)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
has a mean of 113 and SD of 22.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is a constant of 2.75.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">active_water_cost_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sst</span>, <span class="va">int_mean</span>, <span class="va">int_sd</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">int_mean</span>, <span class="va">int_sd</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">int</span><span class="op">-</span><span class="op">(</span><span class="fl">2.75</span><span class="op">*</span><span class="va">sst</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="st">"kJ/h"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># Construct &lt;State&gt; object</span></span>
<span><span class="va">active</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/State.html">State</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"active_on_water"</span>, </span>
<span>  energy_cost <span class="op">=</span> <span class="fu"><a href="../reference/VarFn.html">VarFn</a></span><span class="op">(</span></span>
<span>    <span class="va">active_water_cost_fn</span>, </span>
<span>    args_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sst <span class="op">=</span> <span class="st">"driver"</span>, int_mean <span class="op">=</span> <span class="fl">113</span>, int_sd <span class="op">=</span> <span class="fl">22</span><span class="op">)</span>, </span>
<span>    units <span class="op">=</span> <span class="st">"kJ/hour"</span></span>
<span>  <span class="op">)</span>, </span>
<span>  time_budget <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fl">10.5</span>, <span class="st">"hours/day"</span><span class="op">)</span>, </span>
<span>  speed <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"m/s"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>State for ‘inactive on water’ <span class="citation">(Buckingham et
al. 2023)</span>, follows the same linear function in SST, but where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
has a mean of 72.2 and SD of 22.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is similarly constant at 2.75.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">inactive_water_cost_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sst</span>, <span class="va">int_mean</span>, <span class="va">int_sd</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">int_mean</span>, <span class="va">int_sd</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">int</span><span class="op">-</span><span class="op">(</span><span class="fl">2.75</span><span class="op">*</span><span class="va">sst</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="st">"kJ/h"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">inactive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/State.html">State</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"inactive_on_water"</span>, </span>
<span>  energy_cost <span class="op">=</span> <span class="fu"><a href="../reference/VarFn.html">VarFn</a></span><span class="op">(</span></span>
<span>    <span class="va">active_water_cost_fn</span>, </span>
<span>    args_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sst <span class="op">=</span> <span class="st">"driver"</span>, int_mean <span class="op">=</span> <span class="fl">72.2</span>, int_sd <span class="op">=</span> <span class="fl">22</span><span class="op">)</span>, </span>
<span>    units <span class="op">=</span> <span class="st">"kJ/hour"</span></span>
<span>  <span class="op">)</span>, </span>
<span>  time_budget <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fl">10.3</span>, <span class="st">"hours/day"</span><span class="op">)</span>, </span>
<span>  speed <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"m/s"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These are combined to give a list covering all states:
<code>guill_states</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">guill_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  flight <span class="op">=</span> <span class="va">flight</span>,</span>
<span>  dive <span class="op">=</span> <span class="va">dive</span>,</span>
<span>  active <span class="op">=</span> <span class="va">active</span>,</span>
<span>  inactive <span class="op">=</span> <span class="va">inactive</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="driver-responses">Driver Responses<a class="anchor" aria-label="anchor" href="#driver-responses"></a>
</h4>
<p>In this section, we define species-level, agent-specific responses to
the environmental drivers introduced and defined earlier. For the
guillemot model, we assign the density drivers - identified as
<code>"dens"</code> (baseline) and <code>"dens_imp"</code> (impacted) -
as the primary determinants of agent movement (density maps as per <span class="citation">Buckingham et al. (2022)</span>). For each scenario, we
also specify the probability that an agent is influenced by the
respective driver. In the baseline case, all agents “respond” to the
density map for their movement. For driver <code>"dens_imp"</code>, this
probability reflects how likely an agent is to respond to a OWF
installation <span class="citation">(Peschko et al. 2024)</span> - hence
their influence map differs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">resp_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DriverResponse.html">DriverResponse</a></span><span class="op">(</span></span>
<span>  driver_id <span class="op">=</span> <span class="st">"dens"</span>,</span>
<span>  movement <span class="op">=</span> <span class="fu"><a href="../reference/MoveInfluence.html">MoveInfluence</a></span><span class="op">(</span></span>
<span>    prob <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_degenerate.html" class="external-link">dist_degenerate</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"attraction"</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"cell-value"</span>,</span>
<span>    sim_stage <span class="op">=</span> <span class="st">"bsln"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">resp_imp_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DriverResponse.html">DriverResponse</a></span><span class="op">(</span></span>
<span>  driver_id <span class="op">=</span> <span class="st">"dens_imp"</span>,</span>
<span>  movement <span class="op">=</span> <span class="fu"><a href="../reference/MoveInfluence.html">MoveInfluence</a></span><span class="op">(</span></span>
<span>    prob <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0.67</span>, sd <span class="op">=</span> <span class="fl">0.061</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"attraction"</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"cell-value"</span>,</span>
<span>    sim_stage <span class="op">=</span> <span class="st">"imp"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-the-species-object">Create the <code>&lt;Species&gt;</code> object<a class="anchor" aria-label="anchor" href="#create-the-species-object"></a>
</h4>
<p>In addition to the parameters defined above, we set the remaining
species-level properties, including the body mass distribution (used to
initialise each agent’s body mass) and the energy-to-mass conversion
rate <span class="citation">(Dunn et al. 2022)</span>, which is assumed
constant across agents and simulated time steps. The distribution of
body mass at start of breeding season was drawn/inferred from <span class="citation">Harris and Wanless (1988)</span> (with additional
advice from F. Daunt, <em>pers. comm.</em>, 2025) .</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">guill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Species.html">Species</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"guill"</span>,</span>
<span>  common_name <span class="op">=</span> <span class="st">"guillemot"</span>,</span>
<span>  scientific_name <span class="op">=</span> <span class="st">"Uria Aalge"</span>,</span>
<span>  body_mass_distr <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">929</span>, sd <span class="op">=</span> <span class="fl">56</span><span class="op">)</span>, <span class="st">"g"</span><span class="op">)</span>,</span>
<span>  energy_to_mass_distr <span class="op">=</span> <span class="fu"><a href="../reference/VarDist.html">VarDist</a></span><span class="op">(</span><span class="fl">0.072</span>, <span class="st">"g/kJ"</span><span class="op">)</span>,</span>
<span>  states_profile <span class="op">=</span> <span class="va">guill_states</span>,</span>
<span>  driver_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">resp_dens</span>, <span class="va">resp_imp_dens</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-and-running-the-ibm">Setting up and running the IBM<a class="anchor" aria-label="anchor" href="#setting-up-and-running-the-ibm"></a>
</h2>
<p>Now the key components of the IBM have been specified,
<a href="https://dmpstats.github.io/roamR/">roamR</a> can be used for the initialisation and running of
the simulations.</p>
<div class="section level3">
<h3 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h3>
<p>The intialisation stage performs two main tasks prior to running:</p>
<ul>
<li>The checking of inputs for conformity, some adjustments
(e.g. clipping to the AoC) and derivation of of vector fields where
needed.</li>
<li>The generation the <code>n_agents</code> as indicated in the model
config object.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1009</span><span class="op">)</span></span>
<span></span>
<span><span class="va">guill_ibm</span> <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/rmr_initiate.html">rmr_initiate</a></span><span class="op">(</span></span>
<span>  model_config <span class="op">=</span> <span class="va">guill_ibm_config</span>,</span>
<span>  species <span class="op">=</span> <span class="va">guill</span>,</span>
<span>  drivers <span class="op">=</span> <span class="va">guill_drivers</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-the-simulation">Running the simulation<a class="anchor" aria-label="anchor" href="#running-the-simulation"></a>
</h3>
<p>The running of the simulation involves moving each of the initialised
agents through the defined environment, with monitoring of their
condition through time and determining their responses to these.
Parallelisation is dealt with (and assumed to be generally used) such
that individual agents are piped out to independent threads of
calculation - hence the speed of a simulation is a function of the
number of cores available<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The &lt;code&gt;furrr&lt;/code&gt; package handles the
parallelisation&lt;/p&gt;"><sup>2</sup></a>.</p>
<p>Much of the parameterisiation and data from previous sections are
encapsulated within the <code>ibm</code> object (<code>guill_ibm</code>)
passed to the simulation. Several additional parameters as per
documentation can be entered here as needed. Here we specify:</p>
<ul>
<li>What state(s) are feeding states or resting states - the
state-balancing calculations (refer to main documentation) will
increase/decrease these as required</li>
<li>
<code>feed_avg_net_energy</code> the average net energy per unit
feeding - here a tuning parameter, calculable directly as the energy
required to balance the energetics equations for an average agent.</li>
<li>
<code>target_energy</code> the objective of the state rebalancing in
terms of daily energy (refer to main documentation). This controls the
extent agents change their feeding behaviour in response to feeding
success - low success means more feeding the following day. This is
expressed as a target daily net energy, which here is a modest positive
value, based on empirical results of body mass at the start and end of
the non-breeding season (<em>pers. comm.</em> F. Daunt 2025).</li>
<li>
<code>smooth_body_mass</code> a use-defined function to convert
energy time-series to mass. Here mass deposition occurs as a function of
the preceding 7 days energy intake (<em>pers. comm.</em> J. Green,
2025).</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">guill_results</span> <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/run_disnbs.html">run_disnbs</a></span><span class="op">(</span></span>
<span>  ibm <span class="op">=</span> <span class="va">guill_ibm</span>,</span>
<span>  run_scen <span class="op">=</span> <span class="st">"baseline-and-impact"</span>, </span>
<span>  dens_id <span class="op">=</span> <span class="st">"dens"</span>, </span>
<span>  intake_id <span class="op">=</span> <span class="st">"energy"</span>, </span>
<span>  imp_dens_id <span class="op">=</span> <span class="st">"dens_imp"</span>, </span>
<span>  imp_intake_id <span class="op">=</span> <span class="st">"imp_energy"</span>, </span>
<span>  feed_state_id <span class="op">=</span> <span class="st">"diving"</span>, </span>
<span>  roost_state_id <span class="op">=</span> <span class="st">"inactive_on_water"</span>, </span>
<span>  feed_avg_net_energy <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">422</span>, <span class="st">"kJ/h"</span><span class="op">)</span>, </span>
<span>  target_energy <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"kJ"</span><span class="op">)</span>, </span>
<span>  smooth_body_mass <span class="op">=</span> <span class="fu"><a href="../reference/bm_smooth_opts.html">bm_smooth_opts</a></span><span class="op">(</span>time_bw <span class="op">=</span> <span class="st">"7 days"</span><span class="op">)</span>, </span>
<span>  waypnts_res <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>  seed <span class="op">=</span> <span class="fl">1990</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="digesting-the-results">Digesting the results<a class="anchor" aria-label="anchor" href="#digesting-the-results"></a>
</h2>
<p><a href="https://dmpstats.github.io/roamR/">roamR</a> records an extensive amount of information from
its running and monitoring of the agents. The primary output is a list,
with one element for each agent. The stored agents consist of three main
components (each their own class, as per the package schema):</p>
<ul>
<li>
<code>properties</code> - were drawn/set at the intialisation of the
simulation from the species definition, remain constant throughout</li>
<li>
<code>condition</code> - the specific condition of the agent at any
point in the simulation. This will be the final condition at when the
simulation completes.</li>
<li>
<code>history</code> - a detailed record of elements of the agent’s
condition throughout the simulation. Spatiotemporally stamped, and
includes post-processed energy-to-mass conversions.</li>
</ul>
<p>These form the basis of any downstream calculations based on the
simulation outputs. When there are impact scenarios in play, there will
be more than one such list, with agents paired over the impact scenarios
e.g. baseline versus impact.</p>
<p>We can examine the agent’s simulation histories directly - here we
have two scenarios, each containing a number of agents:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># two scenarios</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">guill_results</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "agents_bsln" "agents_imp"</span></span>
<span></span>
<span><span class="co"># several agents within each</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">guill_results</span><span class="op">$</span><span class="va">agents_bsln</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span></span>
<span><span class="co"># one agents history</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">guill_results</span><span class="op">$</span><span class="va">agents_bsln</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">history</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'sf' and 'data.frame':   272 obs. of  15 variables:</span></span>
<span><span class="co">#&gt;  $ timestep                          : int  0 1 2 3 4 5 6 7 8 9 ...</span></span>
<span><span class="co">#&gt;  $ timestamp                         : POSIXct, format: NA "2025-07-01" ...</span></span>
<span><span class="co">#&gt;  $ track_id                          : int  0 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ body_mass                         : Units: [g] num  893 843 824 860 787 ...</span></span>
<span><span class="co">#&gt;  $ body_mass_smooth                  : Units: [g] num  NA 841 841 842 842 ...</span></span>
<span><span class="co">#&gt;  $ states_budget.flight              : num  0.00234 0.0025 0.00243 0.00257 0.00229 ...</span></span>
<span><span class="co">#&gt;  $ states_budget.diving              : num  0.1298 0.0677 0.0941 0.0444 0.1454 ...</span></span>
<span><span class="co">#&gt;  $ states_budget.active_on_water     : num  0.438 0.469 0.456 0.481 0.43 ...</span></span>
<span><span class="co">#&gt;  $ states_budget.inactive_on_water   : num  0.43 0.46 0.447 0.472 0.422 ...</span></span>
<span><span class="co">#&gt;  $ states_unit_cost.flight           : Units: [kJ/h] num  0 -326 -580 -268 -380 ...</span></span>
<span><span class="co">#&gt;  $ states_unit_cost.diving           : Units: [kJ/h] num  0 -176.8 -210.4 -138.4 -87.9 ...</span></span>
<span><span class="co">#&gt;  $ states_unit_cost.active_on_water  : Units: [kJ/h] num  0 -108.2 -100.6 -76.2 -118.9 ...</span></span>
<span><span class="co">#&gt;  $ states_unit_cost.inactive_on_water: Units: [kJ/h] num  0 -64.9 -29.3 -47.7 -49.5 ...</span></span>
<span><span class="co">#&gt;  $ energy_expenditure                : Units: [kJ] num  0 -684 -952 -449 -1472 ...</span></span>
<span><span class="co">#&gt;  $ geometry                          :sfc_POINT of length 272; first list element:  'XY' num  526896 6226565</span></span>
<span><span class="co">#&gt;  - attr(*, "sf_column")= chr "geometry"</span></span>
<span><span class="co">#&gt;  - attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:14] "timestep" "timestamp" "track_id" "body_mass" ...</span></span></code></pre></div>
<div class="section level3">
<h3 id="comparing-scenarios">Comparing scenarios<a class="anchor" aria-label="anchor" href="#comparing-scenarios"></a>
</h3>
<p>Here we extract the history from agents under the two scenarios for
comparison. All agents over both scenarios are combined into one
dataset.</p>
<pre><code><span><span class="co">#&gt; Simple feature collection with 2176 features and 19 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 363772.8 ymin: 5958868 xmax: 1143527 ymax: 6746621</span></span>
<span><span class="co">#&gt; Projected CRS: WGS 84 / UTM zone 30N</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      scenario agent timestep  timestamp track_id    body_mass body_mass_smooth</span></span>
<span><span class="co">#&gt; 1  status-quo     1        0       &lt;NA&gt;        0 892.7471 [g]           NA [g]</span></span>
<span><span class="co">#&gt; 2  status-quo     1        1 2025-07-01        1 843.4863 [g]     841.0222 [g]</span></span>
<span><span class="co">#&gt; 3  status-quo     1        2 2025-07-02        1 824.1961 [g]     841.3407 [g]</span></span>
<span><span class="co">#&gt; 4  status-quo     1        3 2025-07-03        1 860.4239 [g]     841.6555 [g]</span></span>
<span><span class="co">#&gt; 5  status-quo     1        4 2025-07-04        1 786.7908 [g]     841.9606 [g]</span></span>
<span><span class="co">#&gt; 6  status-quo     1        5 2025-07-05        1 899.6028 [g]     842.2460 [g]</span></span>
<span><span class="co">#&gt; 7  status-quo     1        6 2025-07-06        1 851.8596 [g]     842.5069 [g]</span></span>
<span><span class="co">#&gt; 8  status-quo     1        7 2025-07-07        1 797.9183 [g]     842.7435 [g]</span></span>
<span><span class="co">#&gt; 9  status-quo     1        8 2025-07-08        1 860.3766 [g]     842.9635 [g]</span></span>
<span><span class="co">#&gt; 10 status-quo     1        9 2025-07-09        1 844.7294 [g]     843.1735 [g]</span></span>
<span><span class="co">#&gt;    states_budget.flight states_budget.diving states_budget.active_on_water</span></span>
<span><span class="co">#&gt; 1           0.002336644           0.12976717                     0.4381207</span></span>
<span><span class="co">#&gt; 2           0.002503428           0.06765173                     0.4693928</span></span>
<span><span class="co">#&gt; 3           0.002432399           0.09410517                     0.4560748</span></span>
<span><span class="co">#&gt; 4           0.002565795           0.04442471                     0.4810865</span></span>
<span><span class="co">#&gt; 5           0.002294667           0.14540035                     0.4302501</span></span>
<span><span class="co">#&gt; 6           0.002685079           0.00000000                     0.5034522</span></span>
<span><span class="co">#&gt; 7           0.002534260           0.05616915                     0.4751738</span></span>
<span><span class="co">#&gt; 8           0.002335640           0.13014076                     0.4379326</span></span>
<span><span class="co">#&gt; 9           0.002565621           0.04448955                     0.4810539</span></span>
<span><span class="co">#&gt; 10          0.002508006           0.06594702                     0.4702511</span></span>
<span><span class="co">#&gt;    states_budget.inactive_on_water states_unit_cost.flight</span></span>
<span><span class="co">#&gt; 1                        0.4297755           0.0000 [kJ/h]</span></span>
<span><span class="co">#&gt; 2                        0.4604520        -326.0301 [kJ/h]</span></span>
<span><span class="co">#&gt; 3                        0.4473876        -580.4143 [kJ/h]</span></span>
<span><span class="co">#&gt; 4                        0.4719230        -267.6850 [kJ/h]</span></span>
<span><span class="co">#&gt; 5                        0.4220549        -380.0569 [kJ/h]</span></span>
<span><span class="co">#&gt; 6                        0.4938627        -540.9809 [kJ/h]</span></span>
<span><span class="co">#&gt; 7                        0.4661228        -458.9594 [kJ/h]</span></span>
<span><span class="co">#&gt; 8                        0.4295910        -452.3054 [kJ/h]</span></span>
<span><span class="co">#&gt; 9                        0.4718909        -173.1052 [kJ/h]</span></span>
<span><span class="co">#&gt; 10                       0.4612939        -818.3772 [kJ/h]</span></span>
<span><span class="co">#&gt;    states_unit_cost.diving states_unit_cost.active_on_water</span></span>
<span><span class="co">#&gt; 1           0.00000 [kJ/h]                   0.00000 [kJ/h]</span></span>
<span><span class="co">#&gt; 2        -176.78357 [kJ/h]                -108.17686 [kJ/h]</span></span>
<span><span class="co">#&gt; 3        -210.44304 [kJ/h]                -100.59187 [kJ/h]</span></span>
<span><span class="co">#&gt; 4        -138.40550 [kJ/h]                 -76.24058 [kJ/h]</span></span>
<span><span class="co">#&gt; 5         -87.91532 [kJ/h]                -118.91570 [kJ/h]</span></span>
<span><span class="co">#&gt; 6         -90.63622 [kJ/h]                -132.35904 [kJ/h]</span></span>
<span><span class="co">#&gt; 7         -87.63698 [kJ/h]                 -34.04614 [kJ/h]</span></span>
<span><span class="co">#&gt; 8         -66.87361 [kJ/h]                -123.85927 [kJ/h]</span></span>
<span><span class="co">#&gt; 9        -178.81558 [kJ/h]                 -91.25478 [kJ/h]</span></span>
<span><span class="co">#&gt; 10       -142.40802 [kJ/h]                 -84.17964 [kJ/h]</span></span>
<span><span class="co">#&gt;    states_unit_cost.inactive_on_water energy_expenditure       Date month</span></span>
<span><span class="co">#&gt; 1                     0.000000 [kJ/h]       0.00000 [kJ]       &lt;NA&gt;    NA</span></span>
<span><span class="co">#&gt; 2                   -64.856872 [kJ/h]    -684.17668 [kJ] 2025-07-01     7</span></span>
<span><span class="co">#&gt; 3                   -29.316059 [kJ/h]    -952.09712 [kJ] 2025-07-02     7</span></span>
<span><span class="co">#&gt; 4                   -47.738181 [kJ/h]    -448.93350 [kJ] 2025-07-03     7</span></span>
<span><span class="co">#&gt; 5                   -49.479257 [kJ/h]   -1471.61472 [kJ] 2025-07-04     7</span></span>
<span><span class="co">#&gt; 6                    -8.571322 [kJ/h]      95.21804 [kJ] 2025-07-05     7</span></span>
<span><span class="co">#&gt; 7                   -10.708986 [kJ/h]    -567.88115 [kJ] 2025-07-06     7</span></span>
<span><span class="co">#&gt; 8                   -46.383505 [kJ/h]   -1317.06559 [kJ] 2025-07-07     7</span></span>
<span><span class="co">#&gt; 9                   -59.964954 [kJ/h]    -449.59019 [kJ] 2025-07-08     7</span></span>
<span><span class="co">#&gt; 10                   -6.390341 [kJ/h]    -666.91142 [kJ] 2025-07-09     7</span></span>
<span><span class="co">#&gt;    suscep                 geometry</span></span>
<span><span class="co">#&gt; 1   FALSE POINT (526895.8 6226565)</span></span>
<span><span class="co">#&gt; 2   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 3   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 4   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 5   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 6   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 7   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 8   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 9   FALSE POINT (543716.2 6248777)</span></span>
<span><span class="co">#&gt; 10  FALSE POINT (543716.2 6248777)</span></span></code></pre>
<div class="section level4">
<h4 id="body-mass-traces">body mass traces<a class="anchor" aria-label="anchor" href="#body-mass-traces"></a>
</h4>
<p>We can examine a small number of agents graphically - here their body
mass histories as implied by the simulated energetics. Note
<a href="https://dmpstats.github.io/roamR/">roamR</a> at its heart simulates energetics, so conversion
functions from energy to mass are specified by the user. Here the
primary conversion figure is from <span class="citation">Dunn et al.
(2022)</span>, relating energy to grams of body mass.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_bdm</span> <span class="op">&lt;-</span> <span class="va">guill_history</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">body_mass_smooth</span>, col <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">agent</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">p_bdm</span></span></code></pre></div>
<p><img src="case-study-guillemot_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"images/body mass.png"</span>, <span class="va">p_bdm</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="agent-tracks">Agent tracks<a class="anchor" aria-label="anchor" href="#agent-tracks"></a>
</h4>
<p>Similarly movement tracks for select agents over time can be
visualised, under the two impact scenarios. Here we separate by a
property of the agent - those that were assigned susceptibility to OWF
in the agent initialisation - recalling this was a stochastic
specification at the species level.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_tracks</span> <span class="op">&lt;-</span> <span class="va">guill_history</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="va">timestamp</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">suscep</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">agent</span> <span class="op">==</span> <span class="fu">last</span><span class="op">(</span><span class="va">agent</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/geom_stars.html" class="external-link">geom_stars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spec_imp_map</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Greys"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">month</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Monthly movement tracks for a non-sensitive agent"</span>, subtitle <span class="op">=</span> <span class="st">"Status-quo Vs Impacted scenarios"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">p_tracks</span></span></code></pre></div>
<p><img src="case-study-guillemot_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"images/tracks_non_susceptile_agent.png"</span>, <span class="va">p_tracks</span>, width <span class="op">=</span> <span class="fl">15</span>, height <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_tracks</span> <span class="op">&lt;-</span> <span class="va">guill_history</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="va">timestamp</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">suscep</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">agent</span> <span class="op">==</span> <span class="fu">last</span><span class="op">(</span><span class="va">agent</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/geom_stars.html" class="external-link">geom_stars</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spec_imp_map</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Greys"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">month</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Monthly movement tracks for a sensitive agent"</span>, subtitle <span class="op">=</span> <span class="st">"Status-quo Vs Impacted scenarios"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_tracks</span></span></code></pre></div>
<p><img src="case-study-guillemot_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"images/tracks_susceptile_agent.png"</span>, <span class="va">p_tracks</span>, width <span class="op">=</span> <span class="fl">15</span>, height <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="use-of-counterfactals">Use of counterfactals<a class="anchor" aria-label="anchor" href="#use-of-counterfactals"></a>
</h3>
<p>Quantification of the impact of the perturbation can be done on any
of the defined agent condition (and/or history), but for consenting the
utility is through EIAs that likely use:</p>
<ul>
<li>Cumulative net energy</li>
<li>Season-end body mass or mass change</li>
<li>Distributions of activity/behavioural states</li>
<li>Minimum body mass over the season</li>
<li>Mortality</li>
</ul>
<p>These are not single values, but distributions representing the
variability in the simulated populations. While being directly
informative at a population level (e.g. the mean %-age of the population
lost), the distributions are tangible for down-stream calculations. The
most obvious application being in Population Viability Analyses (PVAs)
that are frequently required in EIAs for consenting. There the
counterfactuals may use:</p>
<ul>
<li>Increases in mortality/proportional reductions in population
size</li>
<li>Relationships between body mass and reproductive success, to alter
PVA demographic parameters</li>
</ul>
<p>For example, Natural England provide an R PVA toolset here <a href="https://github.com/naturalengland/Seabird_PVA_Tool" class="external-link">nepva</a>,
frequently used in consenting, where the distributions of productivity
can be specified under differing scenarios. The PVAs provide monte-carlo
simulations of projected population sizes, which are matched
(impact-to-baseline) to give population-level counterfactuals of
impacts. The DisNBS simulations can be used to estimate these
productivities.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Buckingham2022" class="csl-entry">
Buckingham, Lila, Maria I. Bogdanova, Jonathan A. Green, Ruth E. Dunn,
Sarah Wanless, Sophie Bennett, Richard M. Bevan, et al. 2022.
<span>“Interspecific Variation in Non-Breeding Aggregation: A
Multi-Colony Tracking Study of Two Sympatric Seabirds.”</span>
<em>Marine Ecology Progress Series</em> 684: 181–97. <a href="https://doi.org/10.3354/meps13960" class="external-link">https://doi.org/10.3354/meps13960</a>.
</div>
<div id="ref-Buckingham2023" class="csl-entry">
Buckingham, Lila, Francis Daunt, Maria I. Bogdanova, Robert W. Furness,
Sophie Bennett, James Duckworth, Ruth E. Dunn, et al. 2023.
<span>“Energetic Synchrony Throughout the Non-Breeding Season in Common
Guillemots from Four Colonies.”</span> <em>Journal of Avian Biology</em>
2023 (January). <a href="https://doi.org/10.1111/jav.03018" class="external-link">https://doi.org/10.1111/jav.03018</a>.
</div>
<div id="ref-Dunn2022" class="csl-entry">
Dunn, Ruth E., Jonathan A. Green, Sarah Wanless, Mike P. Harris, Mark A
Newell, Maria I. Bogdanova, Catharine Horswill, Francis Daunt, and Jason
Matthiopoulos. 2022. <span>“Modelling and Mapping How Common Guillemots
Balance Their Energy Budgets over a Full Annual Cycle.”</span>
<em>Functional Ecology</em> 36 (July): 1612–26. <a href="https://doi.org/10.1111/1365-2435.14059" class="external-link">https://doi.org/10.1111/1365-2435.14059</a>.
</div>
<div id="ref-Elliott2013" class="csl-entry">
Elliott, Kyle H., Robert E. Ricklefs, Anthony J. Gaston, Scott A. Hatch,
John R. Speakman, and Gail K. Davoren. 2013. <span>“High Flight Costs,
but Low Dive Costs, in Auks Support the Biomechanical Hypothesis for
Flightlessness in Penguins.”</span> <em>Proceedings of the National
Academy of Sciences of the United States of America</em> 110 (June):
9380–84. <a href="https://doi.org/10.1073/pnas.1304838110" class="external-link">https://doi.org/10.1073/pnas.1304838110</a>.
</div>
<div id="ref-Harris1988" class="csl-entry">
Harris, MP, and S Wanless. 1988. <span>“Measurements and Seasonal
Changes in Weight of Guillemots Uria Aalge at a Breeding Colony.”</span>
<em>Ringing &amp; Migration</em> 9 (1): 32–36.
</div>
<div id="ref-Peschko2024" class="csl-entry">
Peschko, Verena, Henriette Schwemmer, Moritz Mercker, Nele Markones, Kai
Borkenhagen, and Stefan Garthe. 2024. <span>“Cumulative Effects of
Offshore Wind Farms on Common Guillemots (Uria Aalge) in the Southern
North Sea - Climate Versus Biodiversity?”</span> <em>Biodiversity and
Conservation</em> 33 (March): 949–70. <a href="https://doi.org/10.1007/s10531-023-02759-9" class="external-link">https://doi.org/10.1007/s10531-023-02759-9</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carl Donovan, Bruno Caneco.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
